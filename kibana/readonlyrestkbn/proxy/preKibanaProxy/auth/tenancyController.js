"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.TenancyController=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _cookieManager=require("../../core/cookieManager");var __awaiter=void 0&&(void 0).__awaiter||function(e,o,r,u){function c(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(t,r){function n(e){try{i(u.next(e))}catch(e){r(e)}}function a(e){try{i(u["throw"](e))}catch(e){r(e)}}function i(e){e.done?t(e.value):c(e.value).then(n,a)}i((u=u.apply(e,o||[])).next())})};var TenancyController=function e(t,r,n){var o=this;(0,_classCallCheck2.default)(this,e);this.basePath=t;this.authenticationFacade=r;this.cookieConfig=n;this.handleEncryptCookieOnSwitchGroup=function(n,a,i){return __awaiter(o,void 0,void 0,_regenerator.default.mark(function e(){var r;return _regenerator.default.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:t.next=2;return this.authenticationFacade.switchGroups(n.rorRequest);case 2:r=t.sent;if(r){t.next=6;break}a.redirect(this.withBasePath("/logout"));return t.abrupt("return");case 6:a.cookie(this.cookieConfig.name,r,_cookieManager.CookieManager.getCookiesOptions({secure:this.cookieConfig.secure}));i();case 8:case"end":return t.stop()}}},e,this)}))};this.withBasePath=function(e){return o.basePath+e}};exports.TenancyController=TenancyController;